<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="stylesheet" href="../styles/style.css" /><title>A programming language as a series of experiments</title></head><body><p><a href="..#notes">Notes</a><br />2025/10/12</p><h1>A programming language as a series of experiments</h1><p>I've recently been reflecting on my goals for building <a href="https://github.com/fkettelhoit/kombucha">Kombucha</a>. On the one hand, the goal hasn't changed: I want to build a <em>minimal and malleable</em> programming language for <em>symbiotic</em> end-user programming in Rust. But if that were the only goal, success would be solely measured by Kombucha's practical use (and I'm barely using it yet), in other words by how useful its implementation is. Is that all a programming language is?</p><p>Many programming languages, Kombucha included, have a meta goal: To explore the <em>language design space</em> through a series of <em>experiments.</em> They might explore novel individual features (and Kombucha does, for example in its macro system), but most often the contribution of a language is an exploration of how different features <em>interact.</em></p><p>Kombucha is exploring a specific interaction of the following areas:</p><ul><li>Minimal syntax</li><li>Reasonable macros</li><li>Effect handlers</li><li>Currying vs fixed arity</li><li>Live reload</li></ul><h2>Minimal syntax</h2><p>Kombucha is designed as a Lisp-like language without the parentheses. To achieve this, Kombucha supports prefix call syntax, infix call syntax, as well as trailing arguments and keyword arguments. Kombucha's syntax tries to be as <em>general as possible,</em> so that no language constructs need to be privileged.</p><p>Out of all the experiments, Kombucha's syntax experiment is currently the most promising and complete, but it is also the most heavily dependent on other language features (most notably macros).</p><h2>Reasonable macros</h2><p>To be able to implement constructs such as variable assignments and pattern matching as libraries, Kombucha uses a simple macro system. In contrast to most other macro systems, Kombucha's macros are <em>reasonable,</em> meaning that evaluation remains fully referentially transparent without having to first expand macros.</p><p>This experiment has been the most interesting part of Kombucha's design and implementation process. While powerful enough to implement pattern matching as a library, there are still open questions and using a macro system at such an early point made debugging considerably harder. Additionally, some form of partial evaluation is necessary to optimize away the macro system overhead.</p><h2>Effect handlers</h2><p>Kombucha tries to implement various control structures through effect handlers, as well as using effects in combination with a resumable bytecode VM as the standard way of interfacing with a host language.</p><p>This experiment has been largely successful, but there are still open questions when it comes to implementing the highly dynamic aspects of effects (for example, should effect handlers be chosen semi-statically based on the name of the effect or fully dynamically). Ergonomic serialization and deserialization also turned out to be more difficult than at first expected.</p><h2>Currying vs fixed arity</h2><p>With lambda calculus as the starting point for Kombucha, it seemed natural to implement multi-argument functions as curried lambda abstractions. This is elegant, but increases the complexity of the VM considerably.</p><p>This experiment is very much in progress. The initial design used currying, but the next version of Kombucha might switch to fixed arity, similar to most Lisps.</p><h2>Live reload</h2><p>One of the goals was always to design Kombucha as a highly dynamic, reloadable language that plays well with Rust, with live reload as a core feature of the bytecode VM.</p><p>This experiment is still in the design phase.</p><footer>Want to become a better programmer? <a href="https://www.recurse.com/scout/click?t=764048f99cede394c1905c64e1545a5d">Join the Recurse Center!</a></footer></body></html>